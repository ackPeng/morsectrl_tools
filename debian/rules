#!/usr/bin/make -f

# This file is auto generated by rsdk infra-package-update.
# DO NOT EDIT IT DIRECTLY!
# Custom rules should be placed in .github/local/rules.local

include /usr/share/dpkg/pkg-info.mk
include /usr/share/dpkg/architecture.mk
-include .github/local/rules.local

%:
	dh $@ $(EXTRA_DH_OPTIONS)

override_dh_auto_clean:
	dh_clean
	$(MAKE) clean

override_dh_auto_configure:
	# Configure is done via make variables in override_dh_auto_build

override_dh_auto_build:
	# Build morsectrl with NL80211 transport support
	$(MAKE) \
		CC=aarch64-linux-gnu-gcc \
		CONFIG_MORSE_TRANS_NL80211=1 \
		CFLAGS="-I/usr/include/libnl3/" \
		LDFLAGS="-L/usr/lib/aarch64-linux-gnu/"

override_dh_auto_install:
	# Install binaries to debian/tmp
	install -d $(CURDIR)/debian/tmp/usr/bin

	# Install morse_cli with morse prefix
	install -m 755 morse_cli \
		$(CURDIR)/debian/tmp/usr/bin/morsectrl

override_dh_builddeb:
	mkdir -p $(CURDIR)/output
	dh_builddeb --destdir=$(CURDIR)/output -- -Zxz
